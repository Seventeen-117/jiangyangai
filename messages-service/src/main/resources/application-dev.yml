# 开发环境配置

# 服务端口配置
server:
  port: 8081

spring:
  # Seata配置
  cloud:
    alibaba:
      seata:
        tx-service-group: messages-service-group
        service:
          vgroup-mapping:
            messages-service-group: default
          grouplist:
            default: 8.133.246.113:8091
        enable-auto-data-source-proxy: false
  
  # Redis配置
  data:
    redis:
      host: 8.133.246.113
      port: 6379
      password: 
      database: 0
      timeout: 5000ms
      lettuce:
        pool:
          max-active: 8
          max-wait: -1ms
          max-idle: 8
          min-idle: 0

  # RabbitMQ配置（供 Spring AMQP 与健康检查使用）
  rabbitmq:
    host: 8.133.246.113
    port: 5672
    username: guest
    password: guest
    virtual-host: /
    connection-timeout: 30s

# 开发环境日志配置
logging:
  level:
    root: INFO
    org.springframework.boot.autoconfigure: WARN
    org.springframework.boot.autoconfigure.logging: WARN
    org.springframework.boot.diagnostics: WARN

# Dubbo配置
dubbo:
  application:
    name: messages-service
    qos-enable: false
    # 配置唯一的缓存路径，避免多实例冲突
    metadata-type: local
    # 禁用文件缓存，使用内存缓存
    cache-file: false
    # 配置应用实例ID，确保唯一性
    environment: develop
  protocol:
    name: dubbo
    port: -1
    # 配置协议级别的缓存控制
    cache-file: false
  registry:
    address: nacos://8.133.246.113:8848
    timeout: 10000
    # 配置注册中心缓存
    cache-file: false
    # 禁用注册中心文件缓存
    file: false
    # 禁用服务发现缓存
    use-as-config-center: false
    use-as-metadata-center: false
  consumer:
    timeout: 5000
    retries: 2
    check: false
    # 禁用 monitor 过滤器，避免调用 MonitorService
    filter: -monitor
    # 禁用消费者缓存
    cache-file: false
    # 配置消费者元数据类型
    metadata-type: local
  provider:
    timeout: 5000
    retries: 2
    # 禁用提供者缓存
    cache-file: false
    # 配置提供者元数据类型
    metadata-type: local
  # 全局配置
  config-center:
    timeout: 3000
    # 禁用配置中心文件缓存
    file: false
  # 不配置 monitor，以避免 MonitorService 触发
  # 禁用所有文件缓存
  cache:
    file:
      enabled: false
  # 禁用服务名称映射
  service-name-mapping:
    enabled: false
    # 禁用映射缓存
    cache:
      file:
        enabled: false

# Actuator配置 - 禁用数据源健康检查
management:
  health:
    db:
      enabled: false
  endpoint:
    health:
      show-details: always
      validate-group-membership: false

# 消息服务配置 - 开发环境
message:
  service:
    # 消息服务类型
    type: rocketmq
    
    # 是否启用消息轨迹追踪
    trace-enabled: true
    
    # 消息发送重试次数
    send-retry-times: 2
    
    # 消息发送超时时间（毫秒）
    send-timeout-ms: 5000
    
    # 最大批量发送消息数量
    max-batch-size: 50
    
    # RocketMQ配置 - 开发环境
    rocketmq:
      enabled: true
      name-server: 8.133.246.113:9876
      producer-group: jiangyang-dev-producer-group
      consumer-group: jiangyang-dev-consumer-group
      compression-strategy: LZ4
      retry-sync-times: 2
      retry-async-times: 2
      queue-count-per-topic: 2
      message-retention-hours: 24
    
    # Kafka配置 - 开发环境
    kafka:
      enabled: false
      bootstrap-servers: 8.133.246.113:9092
      consumer-group-id: jiangyang-dev-consumer-group
      acks: 1
      batch-size: 8192
      linger-ms: 10
      buffer-memory: 16777216
    
    # RabbitMQ配置 - 开发环境
    rabbitmq:
      enabled: false
      host: 8.133.246.113
      port: 5672
      username: guest
      password: guest
      virtual-host: /
      connection-timeout: 30000
      heartbeat: 30



